// Firestore Security Rules for QR Visit Application
// Copy these rules to your Firebase Console → Firestore Database → Rules

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Users collection - users can read/write their own profile
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
      
      // Allow public read access for profile pages (needed for public profiles)
      allow read: if true;
      
      // Allow username availability checks (read-only queries)
      allow read: if request.auth != null;
    }
    
    // Test collection - for connectivity testing
    match /test/{document} {
      allow read, write: if request.auth != null;
    }
    
    // Default rule - deny all other access
    match /{document=**} {
      allow read, write: if false;
    }
  }
}

// Instructions:
// 1. Go to Firebase Console (https://console.firebase.google.com)
// 2. Select your project: qr-visit-website
// 3. Navigate to Firestore Database → Rules
// 4. Replace the existing rules with the above rules
// 5. Click "Publish"

// These rules allow:
// - Authenticated users to read/write their own profile
// - Public read access to user profiles (for public profile pages)
// - Username availability checks by authenticated users
// - Test document access for connectivity testing
